(* A Mini Grammar for Literate Clojure Macros in Marmalade *)

code-body = literal-code * code-line * ;

<code-line> = macro literal-code  (* (!blank-line newline)* ; *) ;

literal-code = (#'[^\n#|(]+' | punc | newline)+ ;

<newline> = #'\n+' ;
 
macro = <mac-start> anchor <mac-end> ;

<mac-start> = '#|(' ;

<anchor> = !mac-end #'[^)]+' ;

<mac-end> = ')|#' ;

<punc> = !mac-start #'[#|(]+' ;

(* <blank-line> = '\n' sp #'[\n]+' ; *)

<sp> = #'[ \t]*' ;

<ws> = #'[\s]+';

